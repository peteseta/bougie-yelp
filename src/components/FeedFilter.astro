---
// No props needed â€” purely client-side filtering
---

<div class="feed-filter mb-6 flex flex-wrap gap-2">
  <button class="filter-btn active" data-filter="all">all</button>
  <button class="filter-btn" data-filter="weblog">weblogs</button>
  <button class="filter-btn" data-filter="devlog">devlogs</button>
  <button class="filter-btn" data-filter="writing">writings</button>
</div>

<style>
  .filter-btn {
    @apply rounded border border-skin-line px-3 py-1 text-sm text-skin-base transition-colors;
  }
  .filter-btn:hover {
    @apply border-skin-accent text-skin-accent;
  }
  .filter-btn.active {
    @apply border-skin-accent bg-skin-accent/10 text-skin-accent;
  }
</style>

<script>
  function initFilter() {
    const buttons = document.querySelectorAll<HTMLButtonElement>(".filter-btn");
    const feedItems =
      document.querySelectorAll<HTMLElement>(".feed-item[data-post-type]");

    buttons.forEach(btn => {
      btn.addEventListener("click", () => {
        const filter = btn.dataset.filter!;

        buttons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");

        feedItems.forEach(item => {
          const postType = item.dataset.postType;
          const isFeatured = item.dataset.featured === "true";
          const matchesFilter = filter === "all" || postType === filter;

          // Show featured posts if filter is "all" OR if post matches current filter
          if (isFeatured) {
            item.style.display = matchesFilter ? "" : "none";
          } else {
            item.style.display = matchesFilter ? "" : "none";
          }
        });
      });
    });
  }

  // Run on initial load and after Astro view transitions
  initFilter();
  document.addEventListener("astro:after-swap", initFilter);
</script>
